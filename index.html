<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Babylon.js Playground</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>

  <!-- Babylon globals (kept so window.BABYLON is available if your app expects it) -->
  <script src="https://assets.babylonjs.com/generated/Assets.js"></script>
  <script src="https://cdn.babylonjs.com/recast.js"></script>
  <script src="https://cdn.babylonjs.com/ammo.js"></script>
  <script src="https://cdn.babylonjs.com/havok/HavokPhysics_umd.js"></script>
  <script src="https://cdn.babylonjs.com/cannon.js"></script>
  <script src="https://cdn.babylonjs.com/Oimo.js"></script>
  <script src="https://cdn.babylonjs.com/earcut.min.js"></script>
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
  <script src="https://cdn.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
  <script src="https://cdn.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.js"></script>
  <script src="https://cdn.babylonjs.com/serializers/babylonjs.serializers.min.js"></script>
  <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
  <script src="https://cdn.babylonjs.com/addons/babylonjs.addons.min.js"></script>
  <script src="https://cdn.babylonjs.com/inspector/babylon.inspector.bundle.js"></script>

  <style>
    html,body,#renderCanvas{width:100%;height:100%;margin:0;padding:0;overflow:hidden;background:#000}
  </style>
</head>
<body>
  <canvas id="renderCanvas"></canvas>
  <script type="module">
    // Turn bundle text into a module URL
    const code = "// snapshot:index.js\nvar createScene = async function() {\n  const scene = new BABYLON.Scene(engine);\n  scene.clearColor = new BABYLON.Color4(0.02, 0.02, 0.05, 1);\n  const envTexture = BABYLON.CubeTexture.CreateFromPrefilteredData(\n    \"https://assets.babylonjs.com/environments/studio.env\",\n    scene\n  );\n  scene.environmentTexture = envTexture;\n  scene.createDefaultSkybox(envTexture, true, 1e3, 0.1);\n  const gl = new BABYLON.GlowLayer(\"glow\", scene);\n  gl.intensity = 0.6;\n  const ground = BABYLON.MeshBuilder.CreateGround(\"ground\", { width: 100, height: 100 }, scene);\n  ground.isVisible = false;\n  ground.position.y = -10;\n  const guiPlane = BABYLON.MeshBuilder.CreatePlane(\"guiPlane\", { width: 8, height: 5 }, scene);\n  guiPlane.position = new BABYLON.Vector3(20, 5, -5);\n  guiPlane.billboardMode = BABYLON.Mesh.BILLBOARDMODE_ALL;\n  const advancedTexture = BABYLON.GUI.AdvancedDynamicTexture.CreateForMesh(guiPlane);\n  const rect = new BABYLON.GUI.Rectangle();\n  rect.width = 1;\n  rect.height = 1;\n  rect.cornerRadius = 20;\n  rect.color = \"#00FFFF\";\n  rect.thickness = 4;\n  rect.background = \"rgba(10, 20, 35, 0.9)\";\n  advancedTexture.addControl(rect);\n  const infoText = new BABYLON.GUI.TextBlock();\n  infoText.text = \"\\u3010VR \\u5730\\u8D28\\u534F\\u540C\\u4F1A\\u8BCA\\u7CFB\\u7EDF\\u3011\\n\\n\\u72B6\\u6001: \\u5DF2\\u63A5\\u5165\\u6C89\\u6D78\\u5F0F\\u73AF\\u5883\\n\\u64CD\\u4F5C: \\u4F7F\\u7528\\u624B\\u67C4\\u5C04\\u7EBF\\u6307\\u5411\\u4F53\\u7D20\\n\\u5E76\\u6309\\u4E0B\\u6273\\u673A\\u952E(Trigger)\\u8FDB\\u884C\\u5206\\u6790\";\n  infoText.color = \"white\";\n  infoText.fontSize = 35;\n  infoText.textHorizontalAlignment = BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT;\n  infoText.paddingLeft = \"40px\";\n  infoText.paddingTop = \"40px\";\n  infoText.lineSpacing = \"10px\";\n  infoText.textWrapping = BABYLON.GUI.TextWrapping.WordWrap;\n  rect.addControl(infoText);\n  const camera = new BABYLON.ArcRotateCamera(\"camera\", -Math.PI / 1.8, Math.PI / 2.5, 90, new BABYLON.Vector3(15, -2, 5), scene);\n  camera.attachControl(canvas, true);\n  const anomalyMat = new BABYLON.StandardMaterial(\"anomalyMat\", scene);\n  anomalyMat.diffuseColor = new BABYLON.Color3(0, 1, 1);\n  anomalyMat.emissiveColor = new BABYLON.Color3(0, 0.3, 0.3);\n  anomalyMat.alpha = 0.95;\n  const backgroundMat = new BABYLON.StandardMaterial(\"backgroundMat\", scene);\n  backgroundMat.diffuseColor = new BABYLON.Color3(0.1, 0.2, 0.6);\n  backgroundMat.alpha = 0.15;\n  const url = \"https://raw.githubusercontent.com/kirito2323233/BabylonFile/main/BLOCK10.MOD\";\n  const zDepths = [0, 0.35, 0.7, 1.1, 1.6, 2.3, 3.2, 4.4, 5.8];\n  try {\n    const response = await fetch(url);\n    const text = await response.text();\n    const lines = text.split(/\\r?\\n/);\n    let currentLevel = -1;\n    let rowIndex = 0;\n    const layerGroups = [];\n    for (let i = 0; i < lines.length; i++) {\n      let line = lines[i].trim();\n      if (!line || !line.startsWith(\"LEVEL\") && !/^[01]+$/.test(line)) continue;\n      if (line.startsWith(\"LEVEL\")) {\n        currentLevel++;\n        rowIndex = 0;\n        const h = zDepths[currentLevel + 1] - zDepths[currentLevel];\n        const yPos = -(zDepths[currentLevel] + h / 2);\n        const aP = BABYLON.MeshBuilder.CreateBox(\"aP\" + currentLevel, { width: 0.96, height: h, depth: 0.96 }, scene);\n        aP.material = anomalyMat;\n        aP.position.y = yPos;\n        aP.thinInstanceEnablePicking = true;\n        aP.metadata = { res: 100, lv: currentLevel + 1, depth: zDepths[currentLevel + 1] };\n        const bP = BABYLON.MeshBuilder.CreateBox(\"bP\" + currentLevel, { width: 0.96, height: h, depth: 0.96 }, scene);\n        bP.material = backgroundMat;\n        bP.position.y = yPos;\n        bP.thinInstanceEnablePicking = true;\n        bP.metadata = { res: 10, lv: currentLevel + 1, depth: zDepths[currentLevel + 1] };\n        layerGroups.push({ aP, bP, aMatrices: [], bMatrices: [] });\n        continue;\n      }\n      const group = layerGroups[currentLevel];\n      for (let col = 0; col < line.length; col++) {\n        const matrix = BABYLON.Matrix.Translation(col, 0, rowIndex);\n        line[col] === \"1\" ? group.aMatrices.push(matrix) : group.bMatrices.push(matrix);\n      }\n      rowIndex++;\n    }\n    layerGroups.forEach((g) => {\n      if (g.aMatrices.length > 0) g.aP.thinInstanceSetBuffer(\"matrix\", flatten(g.aMatrices), 16);\n      else g.aP.setEnabled(false);\n      if (g.bMatrices.length > 0) g.bP.thinInstanceSetBuffer(\"matrix\", flatten(g.bMatrices), 16);\n      else g.bP.setEnabled(false);\n    });\n    scene.onPointerObservable.add((pointerInfo) => {\n      const pick = pointerInfo.pickInfo;\n      if (pointerInfo.type === BABYLON.PointerEventTypes.POINTERMOVE) {\n        canvas.style.cursor = pick.hit ? \"pointer\" : \"default\";\n      }\n      if (pointerInfo.type === BABYLON.PointerEventTypes.POINTERDOWN && pick.hit) {\n        const meta = pick.pickedMesh.metadata;\n        const pressure = (2.3 * 9.8 * meta.depth).toFixed(2);\n        const saturation = (100 / Math.log10(meta.res + 5)).toFixed(1);\n        infoText.text = `[ VR \\u5730\\u8D28\\u4F1A\\u8BCA\\u7EC8\\u7AEF ]\n----------------------------\n\\u76EE\\u6807\\u6DF1\\u5EA6: ${meta.depth} m (\\u7B2C ${meta.lv} \\u5C42)\n\\u7535\\u963B\\u7387: ${meta.res} \\u03A9\\xB7m\n\\u5CA9\\u6027: ${meta.res > 50 ? \"\\u9AD8\\u963B\\u5F02\\u5E38\\u4F53\" : \"\\u4F4E\\u963B\\u80CC\\u666F\\u5C42\"}\n\n\\u3010AI \\u4F30\\u7B97\\u53C2\\u6570\\u3011\n\\u4E0A\\u8986\\u538B\\u529B: ${pressure} kPa\n\\u542B\\u6C34\\u9971\\u548C\\u5EA6: ${saturation} %`;\n        rect.background = \"rgba(0, 200, 255, 0.5)\";\n        setTimeout(() => rect.background = \"rgba(10, 20, 35, 0.9)\", 200);\n      }\n    });\n  } catch (e) {\n    console.error(\"\\u6570\\u636E\\u52A0\\u8F7D\\u5931\\u8D25:\", e);\n  }\n  const xrHelper = await scene.createDefaultXRExperienceAsync({\n    // 指定哪些地面可以进行传送移动\n    floorMeshes: [ground]\n  });\n  return scene;\n};\nfunction flatten(m) {\n  const d = new Float32Array(m.length * 16);\n  m.forEach((mat, i) => mat.copyToArray(d, i * 16));\n  return d;\n}\nvar index_default = createScene;\nexport {\n  index_default as default\n};\n//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic25hcHNob3Q6aW5kZXguanMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImNvbnN0IGNyZWF0ZVNjZW5lID0gYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHNjZW5lID0gbmV3IEJBQllMT04uU2NlbmUoZW5naW5lKTtcblxuICAgIC8qID09PT09PT09PT09PT09PT09IDEuIFx1NURFNVx1NEUxQVx1N0VBN1x1NzNBRlx1NTg4M1x1OEJCRVx1N0Y2RSA9PT09PT09PT09PT09PT09PSAqL1xuICAgIHNjZW5lLmNsZWFyQ29sb3IgPSBuZXcgQkFCWUxPTi5Db2xvcjQoMC4wMiwgMC4wMiwgMC4wNSwgMSk7XG4gICAgY29uc3QgZW52VGV4dHVyZSA9IEJBQllMT04uQ3ViZVRleHR1cmUuQ3JlYXRlRnJvbVByZWZpbHRlcmVkRGF0YShcbiAgICAgICAgXCJodHRwczovL2Fzc2V0cy5iYWJ5bG9uanMuY29tL2Vudmlyb25tZW50cy9zdHVkaW8uZW52XCIsIHNjZW5lXG4gICAgKTtcbiAgICBzY2VuZS5lbnZpcm9ubWVudFRleHR1cmUgPSBlbnZUZXh0dXJlO1xuICAgIC8vIFx1OEMwM1x1NjY5N1x1NTkyOVx1N0E3QVx1NzZEMixcdTg0MjVcdTkwMjBcdTU3MzBcdTRFMEJcdTZDMUJcdTU2RjRcbiAgICBzY2VuZS5jcmVhdGVEZWZhdWx0U2t5Ym94KGVudlRleHR1cmUsIHRydWUsIDEwMDAsIDAuMSk7XG4gICAgXG4gICAgY29uc3QgZ2wgPSBuZXcgQkFCWUxPTi5HbG93TGF5ZXIoXCJnbG93XCIsIHNjZW5lKTtcbiAgICBnbC5pbnRlbnNpdHkgPSAwLjY7XG5cbiAgICAvLyBcdTZERkJcdTUyQTBcdTRFMDBcdTRFMkFcdTk2OTBcdTVGNjJcdTc2ODRcdTU3MzBcdTk3NjIsXHU3NTI4XHU0RThFIFZSIFx1NEYyMFx1OTAwMShUZWxlcG9ydGF0aW9uKVxuICAgIGNvbnN0IGdyb3VuZCA9IEJBQllMT04uTWVzaEJ1aWxkZXIuQ3JlYXRlR3JvdW5kKFwiZ3JvdW5kXCIsIHt3aWR0aDogMTAwLCBoZWlnaHQ6IDEwMH0sIHNjZW5lKTtcbiAgICBncm91bmQuaXNWaXNpYmxlID0gZmFsc2U7XG4gICAgZ3JvdW5kLnBvc2l0aW9uLnkgPSAtMTA7IC8vIFx1NjUzRVx1NTcyOFx1NkEyMVx1NTc4Qlx1NEUwQlx1NjVCOVxuXG4gICAgLyogPT09PT09PT09PT09PT09PT0gMi4gVlIgXHU0RTEzXHU1QzVFOjNEIFx1N0E3QVx1OTVGNFx1NjBBQ1x1NkQ2RSBVSSBcdTk3NjJcdTY3N0YgPT09PT09PT09PT09PT09PT0gKi9cbiAgICAvLyBcdTUyMUJcdTVFRkFcdTRFMDBcdTRFMkFcdTVFNzNcdTk3NjJcdTY3NjVcdTYyN0ZcdThGN0QgVUlcbiAgICBjb25zdCBndWlQbGFuZSA9IEJBQllMT04uTWVzaEJ1aWxkZXIuQ3JlYXRlUGxhbmUoXCJndWlQbGFuZVwiLCB7d2lkdGg6IDgsIGhlaWdodDogNX0sIHNjZW5lKTtcbiAgICAvLyBcdTVDMDZcdTk3NjJcdTY3N0ZcdTY1M0VcdTdGNkVcdTU3MjhcdTZBMjFcdTU3OEJcdTRGQTdcdTUyNERcdTY1QjksXHU2NUI5XHU0RkJGXHU2N0U1XHU3NzBCXG4gICAgZ3VpUGxhbmUucG9zaXRpb24gPSBuZXcgQkFCWUxPTi5WZWN0b3IzKDIwLCA1LCAtNSk7XG4gICAgLy8gXHU4QkE5XHU5NzYyXHU2NzdGXHU1OUNCXHU3RUM4XHU5NzYyXHU1NDExXHU3NTI4XHU2MjM3XG4gICAgZ3VpUGxhbmUuYmlsbGJvYXJkTW9kZSA9IEJBQllMT04uTWVzaC5CSUxMQk9BUkRNT0RFX0FMTDtcblxuICAgIC8vIFx1NTIxQlx1NUVGQVx1NzUyOFx1NEU4RSBNZXNoIFx1NzY4NFx1OUFEOFx1N0VBN1x1NTJBOFx1NjAwMVx1N0VCOVx1NzQwNlxuICAgIGNvbnN0IGFkdmFuY2VkVGV4dHVyZSA9IEJBQllMT04uR1VJLkFkdmFuY2VkRHluYW1pY1RleHR1cmUuQ3JlYXRlRm9yTWVzaChndWlQbGFuZSk7XG4gICAgXG4gICAgY29uc3QgcmVjdCA9IG5ldyBCQUJZTE9OLkdVSS5SZWN0YW5nbGUoKTtcbiAgICByZWN0LndpZHRoID0gMTsgLy8gXHU1MzYwXHU2RUUxXHU2NTc0XHU0RTJBXHU1RTczXHU5NzYyXG4gICAgcmVjdC5oZWlnaHQgPSAxO1xuICAgIHJlY3QuY29ybmVyUmFkaXVzID0gMjA7XG4gICAgcmVjdC5jb2xvciA9IFwiIzAwRkZGRlwiO1xuICAgIHJlY3QudGhpY2tuZXNzID0gNDtcbiAgICByZWN0LmJhY2tncm91bmQgPSBcInJnYmEoMTAsIDIwLCAzNSwgMC45KVwiO1xuICAgIGFkdmFuY2VkVGV4dHVyZS5hZGRDb250cm9sKHJlY3QpO1xuXG4gICAgY29uc3QgaW5mb1RleHQgPSBuZXcgQkFCWUxPTi5HVUkuVGV4dEJsb2NrKCk7XG4gICAgLy8gVlIgXHU2QTIxXHU1RjBGXHU0RTBCXHU3Njg0XHU1RjE1XHU1QkZDXHU2NTg3XHU2NzJDXG4gICAgaW5mb1RleHQudGV4dCA9IFwiXHUzMDEwVlIgXHU1NzMwXHU4RDI4XHU1MzRGXHU1NDBDXHU0RjFBXHU4QkNBXHU3Q0ZCXHU3RURGXHUzMDExXFxuXFxuXHU3MkI2XHU2MDAxOiBcdTVERjJcdTYzQTVcdTUxNjVcdTZDODlcdTZENzhcdTVGMEZcdTczQUZcdTU4ODNcXG5cdTY0Q0RcdTRGNUM6IFx1NEY3Rlx1NzUyOFx1NjI0Qlx1NjdDNFx1NUMwNFx1N0VCRlx1NjMwN1x1NTQxMVx1NEY1M1x1N0QyMFxcblx1NUU3Nlx1NjMwOVx1NEUwQlx1NjI3M1x1NjczQVx1OTUyRShUcmlnZ2VyKVx1OEZEQlx1ODg0Q1x1NTIwNlx1Njc5MFwiO1xuICAgIGluZm9UZXh0LmNvbG9yID0gXCJ3aGl0ZVwiO1xuICAgIGluZm9UZXh0LmZvbnRTaXplID0gMzU7IC8vIFZSIFx1OTFDQ1x1NUI1N1x1NEY1M1x1ODk4MVx1NTkyN1xuICAgIGluZm9UZXh0LnRleHRIb3Jpem9udGFsQWxpZ25tZW50ID0gQkFCWUxPTi5HVUkuQ29udHJvbC5IT1JJWk9OVEFMX0FMSUdOTUVOVF9MRUZUO1xuICAgIGluZm9UZXh0LnBhZGRpbmdMZWZ0ID0gXCI0MHB4XCI7XG4gICAgaW5mb1RleHQucGFkZGluZ1RvcCA9IFwiNDBweFwiO1xuICAgIGluZm9UZXh0LmxpbmVTcGFjaW5nID0gXCIxMHB4XCI7XG4gICAgLy8gXHU1MTQxXHU4QkI4XHU2NTg3XHU2NzJDXHU2MzYyXHU4ODRDXG4gICAgaW5mb1RleHQudGV4dFdyYXBwaW5nID0gQkFCWUxPTi5HVUkuVGV4dFdyYXBwaW5nLldvcmRXcmFwO1xuICAgIHJlY3QuYWRkQ29udHJvbChpbmZvVGV4dCk7XG5cbiAgICAvKiA9PT09PT09PT09PT09PT09PSAzLiBcdTc2RjhcdTY3M0FcdTRFMEVcdTY3NTBcdThEMjggPT09PT09PT09PT09PT09PT0gKi9cbiAgICAvLyBcdTY4NENcdTk3NjJcdTZBMjFcdTVGMEZcdTc2RjhcdTY3M0FcdTRGNERcdTdGNkVcdThDMDNcdTY1NzQsXHU4QkE5XHU3NTI4XHU2MjM3XHU0RTAwXHU4RkRCXHU2NzY1XHU1QzMxXHU4MEZEXHU3NzBCXHU1MjMwIFVJIFx1OTc2Mlx1Njc3RlxuICAgIGNvbnN0IGNhbWVyYSA9IG5ldyBCQUJZTE9OLkFyY1JvdGF0ZUNhbWVyYShcImNhbWVyYVwiLCAtTWF0aC5QSS8xLjgsIE1hdGguUEkvMi41LCA5MCwgbmV3IEJBQllMT04uVmVjdG9yMygxNSwgLTIsIDUpLCBzY2VuZSk7XG4gICAgY2FtZXJhLmF0dGFjaENvbnRyb2woY2FudmFzLCB0cnVlKTtcblxuICAgIGNvbnN0IGFub21hbHlNYXQgPSBuZXcgQkFCWUxPTi5TdGFuZGFyZE1hdGVyaWFsKFwiYW5vbWFseU1hdFwiLCBzY2VuZSk7XG4gICAgYW5vbWFseU1hdC5kaWZmdXNlQ29sb3IgPSBuZXcgQkFCWUxPTi5Db2xvcjMoMCwgMSwgMSk7XG4gICAgYW5vbWFseU1hdC5lbWlzc2l2ZUNvbG9yID0gbmV3IEJBQllMT04uQ29sb3IzKDAsIDAuMywgMC4zKTtcbiAgICBhbm9tYWx5TWF0LmFscGhhID0gMC45NTtcblxuICAgIGNvbnN0IGJhY2tncm91bmRNYXQgPSBuZXcgQkFCWUxPTi5TdGFuZGFyZE1hdGVyaWFsKFwiYmFja2dyb3VuZE1hdFwiLCBzY2VuZSk7XG4gICAgYmFja2dyb3VuZE1hdC5kaWZmdXNlQ29sb3IgPSBuZXcgQkFCWUxPTi5Db2xvcjMoMC4xLCAwLjIsIDAuNik7XG4gICAgYmFja2dyb3VuZE1hdC5hbHBoYSA9IDAuMTU7IFxuXG4gICAgLyogPT09PT09PT09PT09PT09PT0gNC4gXHU1MkEwXHU4RjdEXHU2NTcwXHU2MzZFXHU0RTBFXHU2Nzg0XHU1RUZBXHU2QTIxXHU1NzhCIChcdTRGRERcdTYzMDFcdTRFMERcdTUzRDgpID09PT09PT09PT09PT09PT09ICovXG4gICAgY29uc3QgdXJsID0gXCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20va2lyaXRvMjMyMzIzMy9CYWJ5bG9uRmlsZS9tYWluL0JMT0NLMTAuTU9EXCI7XG4gICAgY29uc3QgekRlcHRocyA9IFswLCAwLjM1LCAwLjcwLCAxLjEwLCAxLjYwLCAyLjMwLCAzLjIwLCA0LjQwLCA1LjgwXTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcbiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KC9cXHI/XFxuLyk7XG5cbiAgICAgICAgbGV0IGN1cnJlbnRMZXZlbCA9IC0xO1xuICAgICAgICBsZXQgcm93SW5kZXggPSAwO1xuICAgICAgICBjb25zdCBsYXllckdyb3VwcyA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBsaW5lID0gbGluZXNbaV0udHJpbSgpO1xuICAgICAgICAgICAgaWYgKCFsaW5lIHx8ICghbGluZS5zdGFydHNXaXRoKFwiTEVWRUxcIikgJiYgIS9eWzAxXSskLy50ZXN0KGxpbmUpKSkgY29udGludWU7XG5cbiAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoXCJMRVZFTFwiKSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRMZXZlbCsrO1xuICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gMDtcbiAgICAgICAgICAgICAgICBjb25zdCBoID0gekRlcHRoc1tjdXJyZW50TGV2ZWwgKyAxXSAtIHpEZXB0aHNbY3VycmVudExldmVsXTtcbiAgICAgICAgICAgICAgICBjb25zdCB5UG9zID0gLSh6RGVwdGhzW2N1cnJlbnRMZXZlbF0gKyBoIC8gMik7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBhUCA9IEJBQllMT04uTWVzaEJ1aWxkZXIuQ3JlYXRlQm94KFwiYVBcIitjdXJyZW50TGV2ZWwsIHsgd2lkdGg6IDAuOTYsIGhlaWdodDogaCwgZGVwdGg6IDAuOTYgfSwgc2NlbmUpO1xuICAgICAgICAgICAgICAgIGFQLm1hdGVyaWFsID0gYW5vbWFseU1hdDsgYVAucG9zaXRpb24ueSA9IHlQb3M7XG4gICAgICAgICAgICAgICAgLy8gVlIgXHU2MjRCXHU2N0M0XHU1QzA0XHU3RUJGXHU0RTVGXHU5NzAwXHU4OTgxXHU4RkQ5XHU0RTJBXHU1QzVFXHU2MDI3XHU2MjREXHU4MEZEXHU2MkZFXHU1M0Q2XG4gICAgICAgICAgICAgICAgYVAudGhpbkluc3RhbmNlRW5hYmxlUGlja2luZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgYVAubWV0YWRhdGEgPSB7IHJlczogMTAwLCBsdjogY3VycmVudExldmVsICsgMSwgZGVwdGg6IHpEZXB0aHNbY3VycmVudExldmVsKzFdIH07XG5cbiAgICAgICAgICAgICAgICBjb25zdCBiUCA9IEJBQllMT04uTWVzaEJ1aWxkZXIuQ3JlYXRlQm94KFwiYlBcIitjdXJyZW50TGV2ZWwsIHsgd2lkdGg6IDAuOTYsIGhlaWdodDogaCwgZGVwdGg6IDAuOTYgfSwgc2NlbmUpO1xuICAgICAgICAgICAgICAgIGJQLm1hdGVyaWFsID0gYmFja2dyb3VuZE1hdDsgYlAucG9zaXRpb24ueSA9IHlQb3M7XG4gICAgICAgICAgICAgICAgYlAudGhpbkluc3RhbmNlRW5hYmxlUGlja2luZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgYlAubWV0YWRhdGEgPSB7IHJlczogMTAsIGx2OiBjdXJyZW50TGV2ZWwgKyAxLCBkZXB0aDogekRlcHRoc1tjdXJyZW50TGV2ZWwrMV0gfTtcblxuICAgICAgICAgICAgICAgIGxheWVyR3JvdXBzLnB1c2goeyBhUCwgYlAsIGFNYXRyaWNlczogW10sIGJNYXRyaWNlczogW10gfSk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gbGF5ZXJHcm91cHNbY3VycmVudExldmVsXTtcbiAgICAgICAgICAgIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IGxpbmUubGVuZ3RoOyBjb2wrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IEJBQllMT04uTWF0cml4LlRyYW5zbGF0aW9uKGNvbCwgMCwgcm93SW5kZXgpO1xuICAgICAgICAgICAgICAgIGxpbmVbY29sXSA9PT0gXCIxXCIgPyBncm91cC5hTWF0cmljZXMucHVzaChtYXRyaXgpIDogZ3JvdXAuYk1hdHJpY2VzLnB1c2gobWF0cml4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJvd0luZGV4Kys7XG4gICAgICAgIH1cblxuICAgICAgICBsYXllckdyb3Vwcy5mb3JFYWNoKGcgPT4ge1xuICAgICAgICAgICAgaWYgKGcuYU1hdHJpY2VzLmxlbmd0aCA+IDApIGcuYVAudGhpbkluc3RhbmNlU2V0QnVmZmVyKFwibWF0cml4XCIsIGZsYXR0ZW4oZy5hTWF0cmljZXMpLCAxNik7XG4gICAgICAgICAgICBlbHNlIGcuYVAuc2V0RW5hYmxlZChmYWxzZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChnLmJNYXRyaWNlcy5sZW5ndGggPiAwKSBnLmJQLnRoaW5JbnN0YW5jZVNldEJ1ZmZlcihcIm1hdHJpeFwiLCBmbGF0dGVuKGcuYk1hdHJpY2VzKSwgMTYpO1xuICAgICAgICAgICAgZWxzZSBnLmJQLnNldEVuYWJsZWQoZmFsc2UpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvKiA9PT09PT09PT09PT09PT09PSA1LiBcdTRFQTRcdTRFOTJcdTkwM0JcdThGOTEgKFx1NTE3Q1x1NUJCOVx1OUYyMFx1NjgwN1x1NTQ4QyBWUiBcdTYyNEJcdTY3QzQpID09PT09PT09PT09PT09PT09ICovXG4gICAgICAgIHNjZW5lLm9uUG9pbnRlck9ic2VydmFibGUuYWRkKChwb2ludGVySW5mbykgPT4ge1xuICAgICAgICAgICAgY29uc3QgcGljayA9IHBvaW50ZXJJbmZvLnBpY2tJbmZvO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBcdTlGMjBcdTY4MDdcdTZBMjFcdTVGMEZcdTRFMEJcdTY1MzlcdTUzRDhcdTUxNDlcdTY4MDcgKFZSXHU2QTIxXHU1RjBGXHU0RTBCXHU0RjFBXHU4MUVBXHU1MkE4XHU2NjNFXHU3OTNBXHU1QzA0XHU3RUJGKVxuICAgICAgICAgICAgaWYgKHBvaW50ZXJJbmZvLnR5cGUgPT09IEJBQllMT04uUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUk1PVkUpIHtcbiAgICAgICAgICAgICAgICBjYW52YXMuc3R5bGUuY3Vyc29yID0gcGljay5oaXQgPyBcInBvaW50ZXJcIiA6IFwiZGVmYXVsdFwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBcdTcwQjlcdTUxRkJcdTYyMTYgVlJcdTYyNzNcdTY3M0FcdTk1MkVcdTYzMDlcdTRFMEJcbiAgICAgICAgICAgIGlmIChwb2ludGVySW5mby50eXBlID09PSBCQUJZTE9OLlBvaW50ZXJFdmVudFR5cGVzLlBPSU5URVJET1dOICYmIHBpY2suaGl0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWV0YSA9IHBpY2sucGlja2VkTWVzaC5tZXRhZGF0YTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBcdTZBMjFcdTYyREYgQUkgXHU4QkExXHU3Qjk3XG4gICAgICAgICAgICAgICAgY29uc3QgcHJlc3N1cmUgPSAoMi4zICogOS44ICogbWV0YS5kZXB0aCkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzYXR1cmF0aW9uID0gKDEwMCAvIE1hdGgubG9nMTAobWV0YS5yZXMgKyA1KSkudG9GaXhlZCgxKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBcdTY2RjRcdTY1QjAgM0QgXHU3QTdBXHU5NUY0XHU5NzYyXHU2NzdGXHU3Njg0XHU1MTg1XHU1QkI5XG4gICAgICAgICAgICAgICAgaW5mb1RleHQudGV4dCA9IGBbIFZSIFx1NTczMFx1OEQyOFx1NEYxQVx1OEJDQVx1N0VDOFx1N0FFRiBdXFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxcblx1NzZFRVx1NjgwN1x1NkRGMVx1NUVBNjogJHttZXRhLmRlcHRofSBtIChcdTdCMkMgJHttZXRhLmx2fSBcdTVDNDIpXFxuXHU3NTM1XHU5NjNCXHU3Mzg3OiAke21ldGEucmVzfSBcdTAzQTlcdTAwQjdtXFxuXHU1Q0E5XHU2MDI3OiAke21ldGEucmVzID4gNTAgPyAnXHU5QUQ4XHU5NjNCXHU1RjAyXHU1RTM4XHU0RjUzJyA6ICdcdTRGNEVcdTk2M0JcdTgwQ0NcdTY2NkZcdTVDNDInfVxcblxcblx1MzAxMEFJIFx1NEYzMFx1N0I5N1x1NTNDMlx1NjU3MFx1MzAxMVxcblx1NEUwQVx1ODk4Nlx1NTM4Qlx1NTI5QjogJHtwcmVzc3VyZX0ga1BhXFxuXHU1NDJCXHU2QzM0XHU5OTcxXHU1NDhDXHU1RUE2OiAke3NhdHVyYXRpb259ICVgO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFx1NEVBNFx1NEU5Mlx1NTNDRFx1OTk4ODpcdTk3NjJcdTY3N0ZcdTk1RUFcdTcwQzFcbiAgICAgICAgICAgICAgICByZWN0LmJhY2tncm91bmQgPSBcInJnYmEoMCwgMjAwLCAyNTUsIDAuNSlcIjtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlY3QuYmFja2dyb3VuZCA9IFwicmdiYSgxMCwgMjAsIDM1LCAwLjkpXCIsIDIwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgfSBjYXRjaCAoZSkgeyBjb25zb2xlLmVycm9yKFwiXHU2NTcwXHU2MzZFXHU1MkEwXHU4RjdEXHU1OTMxXHU4RDI1OlwiLCBlKTsgfVxuXG4gICAgLyogPT09PT09PT09PT09PT09PT0gNi4gXHU2ODM4XHU1RkMzOlx1NEUwMFx1ODg0Q1x1NEVFM1x1NzgwMVx1NUYwMFx1NTQyRiBXZWJYUiBcdTY1MkZcdTYzMDEgPT09PT09PT09PT09PT09PT0gKi9cbiAgICAvLyBcdTUyMUJcdTVFRkFcdTlFRDhcdThCQTRcdTc2ODQgWFIgXHU0RjUzXHU5QThDLFx1NTMwNVx1NjJFQyBVSVx1NjMwOVx1OTRBRVx1MzAwMVx1OEY5M1x1NTE2NVx1NjNBN1x1NTIzNlx1NTY2OFx1NTQ4Q1x1NEYyMFx1OTAwMVx1NjczQVx1NTIzNlxuICAgIGNvbnN0IHhySGVscGVyID0gYXdhaXQgc2NlbmUuY3JlYXRlRGVmYXVsdFhSRXhwZXJpZW5jZUFzeW5jKHtcbiAgICAgICAgLy8gXHU2MzA3XHU1QjlBXHU1NEVBXHU0RTlCXHU1NzMwXHU5NzYyXHU1M0VGXHU0RUU1XHU4RkRCXHU4ODRDXHU0RjIwXHU5MDAxXHU3OUZCXHU1MkE4XG4gICAgICAgIGZsb29yTWVzaGVzOiBbZ3JvdW5kXVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNjZW5lO1xufTtcblxuZnVuY3Rpb24gZmxhdHRlbihtKSB7XG4gICAgY29uc3QgZCA9IG5ldyBGbG9hdDMyQXJyYXkobS5sZW5ndGggKiAxNik7XG4gICAgbS5mb3JFYWNoKChtYXQsIGkpID0+IG1hdC5jb3B5VG9BcnJheShkLCBpICogMTYpKTtcbiAgICByZXR1cm4gZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY3JlYXRlU2NlbmU7XG4vLyMgc291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LFVBQVUsUUFBUSxFQUFFLFNBQVMsR0FBRyxFQUFFO0FBQUEsVUFDcEYsR0FBRSxHQUFHLFdBQVcsS0FBSztBQUUxQixVQUFJLEVBQUUsVUFBVSxTQUFTLEVBQUcsR0FBRSxHQUFHLHNCQUFzQixVQUFVLFFBQVEsRUFBRSxTQUFTLEdBQUcsRUFBRTtBQUFBLFVBQ3BGLEdBQUUsR0FBRyxXQUFXLEtBQUs7QUFBQSxJQUM5QixDQUFDO0FBR0QsVUFBTSxvQkFBb0IsSUFBSSxDQUFDLGdCQUFnQjtBQUMzQyxZQUFNLE9BQU8sWUFBWTtBQUd6QixVQUFJLFlBQVksU0FBUyxRQUFRLGtCQUFrQixhQUFhO0FBQzVELGVBQU8sTUFBTSxTQUFTLEtBQUssTUFBTSxZQUFZO0FBQUEsTUFDakQ7QUFHQSxVQUFJLFlBQVksU0FBUyxRQUFRLGtCQUFrQixlQUFlLEtBQUssS0FBSztBQUN4RSxjQUFNLE9BQU8sS0FBSyxXQUFXO0FBRzdCLGNBQU0sWUFBWSxNQUFNLE1BQU0sS0FBSyxPQUFPLFFBQVEsQ0FBQztBQUNuRCxjQUFNLGNBQWMsTUFBTSxLQUFLLE1BQU0sS0FBSyxNQUFNLENBQUMsR0FBRyxRQUFRLENBQUM7QUFHN0QsaUJBQVMsT0FBTztBQUFBO0FBQUEsNEJBQXNELEtBQUssS0FBSyxjQUFTLEtBQUssRUFBRTtBQUFBLHNCQUFhLEtBQUssR0FBRztBQUFBLGdCQUFhLEtBQUssTUFBTSxLQUFLLG1DQUFVLGdDQUFPO0FBQUE7QUFBQTtBQUFBLDRCQUF3QixRQUFRO0FBQUEsa0NBQWdCLFVBQVU7QUFHN04sYUFBSyxhQUFhO0FBQ2xCLG1CQUFXLE1BQU0sS0FBSyxhQUFhLHlCQUF5QixHQUFHO0FBQUEsTUFDbkU7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUVMLFNBQVMsR0FBRztBQUFFLFlBQVEsTUFBTSx5Q0FBVyxDQUFDO0FBQUEsRUFBRztBQUkzQyxRQUFNLFdBQVcsTUFBTSxNQUFNLCtCQUErQjtBQUFBO0FBQUEsSUFFeEQsYUFBYSxDQUFDLE1BQU07QUFBQSxFQUN4QixDQUFDO0FBRUQsU0FBTztBQUNYO0FBRUEsU0FBUyxRQUFRLEdBQUc7QUFDaEIsUUFBTSxJQUFJLElBQUksYUFBYSxFQUFFLFNBQVMsRUFBRTtBQUN4QyxJQUFFLFFBQVEsQ0FBQyxLQUFLLE1BQU0sSUFBSSxZQUFZLEdBQUcsSUFBSSxFQUFFLENBQUM7QUFDaEQsU0FBTztBQUNYO0FBRUEsSUFBTyxnQkFBUTsiLAogICJuYW1lcyI6IFtdCn0K\n";
    const blob = new Blob([code], { type: 'text/javascript' });
    const url = URL.createObjectURL(blob);

    const BABYLON = window.BABYLON;
    const canvas = document.getElementById('renderCanvas');

    // Import your bundled app (which exports createScene / default)
    const mod = await import(url);

    let engine = null;
    if (typeof mod.createEngine === 'function') {
      try { engine = await mod.createEngine(); } catch {}
    }
    if (!engine) {
      engine = new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true });
    }
    window.engine = engine; window.canvas = canvas;

    let createScene = mod.createScene || mod.default;
    if (!createScene && mod.Playground?.CreateScene) createScene = (e,c)=>mod.Playground.CreateScene(e,c);
    if (!createScene) throw new Error('No createScene() export found.');

    const scene = await (createScene(engine, canvas) ?? createScene());
    engine.runRenderLoop(()=>scene.render());
    addEventListener('resize', ()=>engine.resize());

    addEventListener('unload', ()=> URL.revokeObjectURL(url));
  </script>
</body>
</html>