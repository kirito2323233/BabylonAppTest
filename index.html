<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Babylon.js Playground</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>

  <!-- Babylon globals (kept so window.BABYLON is available if your app expects it) -->
  <script src="https://assets.babylonjs.com/generated/Assets.js"></script>
  <script src="https://cdn.babylonjs.com/recast.js"></script>
  <script src="https://cdn.babylonjs.com/ammo.js"></script>
  <script src="https://cdn.babylonjs.com/havok/HavokPhysics_umd.js"></script>
  <script src="https://cdn.babylonjs.com/cannon.js"></script>
  <script src="https://cdn.babylonjs.com/Oimo.js"></script>
  <script src="https://cdn.babylonjs.com/earcut.min.js"></script>
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
  <script src="https://cdn.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
  <script src="https://cdn.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.js"></script>
  <script src="https://cdn.babylonjs.com/serializers/babylonjs.serializers.min.js"></script>
  <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
  <script src="https://cdn.babylonjs.com/addons/babylonjs.addons.min.js"></script>
  <script src="https://cdn.babylonjs.com/inspector/babylon.inspector.bundle.js"></script>

  <style>
    html,body,#renderCanvas{width:100%;height:100%;margin:0;padding:0;overflow:hidden;background:#000}
  </style>
</head>
<body>
  <canvas id="renderCanvas"></canvas>
  <script type="module">
    // Turn bundle text into a module URL
    const code = "// snapshot:index.js\nvar createScene = function() {\n  var scene = new BABYLON.Scene(engine);\n  scene.clearColor = new BABYLON.Color4(0.05, 0.05, 0.08, 1);\n  var camera = new BABYLON.ArcRotateCamera(\n    \"camera\",\n    -Math.PI / 2,\n    Math.PI / 3,\n    25,\n    new BABYLON.Vector3(0, 3, 0),\n    scene\n  );\n  camera.attachControl(canvas, true);\n  var light = new BABYLON.HemisphericLight(\n    \"light\",\n    new BABYLON.Vector3(0, 1, 0),\n    scene\n  );\n  light.intensity = 0.9;\n  var ground = BABYLON.MeshBuilder.CreateGround(\n    \"ground\",\n    { width: 50, height: 50 },\n    scene\n  );\n  ground.isVisible = false;\n  var nx = 10, ny = 5, nz = 10;\n  var dx = 1, dy = 0.6, dz = 1;\n  var modelRoot = new BABYLON.TransformNode(\"modelRoot\", scene);\n  function resistivityToColor(v) {\n    var t = BABYLON.Scalar.Clamp(v / 100, 0, 1);\n    return new BABYLON.Color3(t, 0.2, 1 - t);\n  }\n  for (let i = 0; i < nx; i++) {\n    for (let j = 0; j < ny; j++) {\n      for (let k = 0; k < nz; k++) {\n        var dist = Math.abs(i - nx / 2) + Math.abs(j - ny / 2) + Math.abs(k - nz / 2);\n        var resistivity = dist < 4 ? 20 : 120;\n        var box = BABYLON.MeshBuilder.CreateBox(\n          \"cell\",\n          { width: dx, height: dy, depth: dz },\n          scene\n        );\n        box.position.set(i * dx, j * dy, k * dz);\n        var mat = new BABYLON.StandardMaterial(\"mat\", scene);\n        mat.diffuseColor = resistivityToColor(resistivity);\n        mat.alpha = resistivity < 50 ? 0.9 : 0.35;\n        box.material = mat;\n        box.parent = modelRoot;\n      }\n    }\n  }\n  modelRoot.position.x = -nx * dx / 2;\n  modelRoot.position.z = -nz * dz / 2;\n  modelRoot.position.y = 0.5;\n  scene.createDefaultXRExperienceAsync({\n    floorMeshes: [ground]\n  });\n  return scene;\n};\nvar index_default = createScene;\nexport {\n  index_default as default\n};\n//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic25hcHNob3Q6aW5kZXguanMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbInZhciBjcmVhdGVTY2VuZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzY2VuZSA9IG5ldyBCQUJZTE9OLlNjZW5lKGVuZ2luZSk7XG4gICAgc2NlbmUuY2xlYXJDb2xvciA9IG5ldyBCQUJZTE9OLkNvbG9yNCgwLjA1LCAwLjA1LCAwLjA4LCAxKTtcblxuICAgIC8qID09PT09PT09PSBcdTY2NkVcdTkwMUFcdTc2RjhcdTY3M0EoXHU1MTczXHU5NTJFIVx1NTQyNlx1NTIxOVx1OUVEMVx1NUM0RikgPT09PT09PT09ICovXG4gICAgdmFyIGNhbWVyYSA9IG5ldyBCQUJZTE9OLkFyY1JvdGF0ZUNhbWVyYShcbiAgICAgICAgXCJjYW1lcmFcIixcbiAgICAgICAgLU1hdGguUEkgLyAyLFxuICAgICAgICBNYXRoLlBJIC8gMyxcbiAgICAgICAgMjUsXG4gICAgICAgIG5ldyBCQUJZTE9OLlZlY3RvcjMoMCwgMywgMCksXG4gICAgICAgIHNjZW5lXG4gICAgKTtcbiAgICBjYW1lcmEuYXR0YWNoQ29udHJvbChjYW52YXMsIHRydWUpO1xuXG4gICAgLyogPT09PT09PT09IFx1NTE0OVx1NzE2NyA9PT09PT09PT0gKi9cbiAgICB2YXIgbGlnaHQgPSBuZXcgQkFCWUxPTi5IZW1pc3BoZXJpY0xpZ2h0KFxuICAgICAgICBcImxpZ2h0XCIsXG4gICAgICAgIG5ldyBCQUJZTE9OLlZlY3RvcjMoMCwgMSwgMCksXG4gICAgICAgIHNjZW5lXG4gICAgKTtcbiAgICBsaWdodC5pbnRlbnNpdHkgPSAwLjk7XG5cbiAgICAvKiA9PT09PT09PT0gXHU1NzMwXHU5NzYyKFx1N0VEOSBYUiBcdTc1MjgpID09PT09PT09PSAqL1xuICAgIHZhciBncm91bmQgPSBCQUJZTE9OLk1lc2hCdWlsZGVyLkNyZWF0ZUdyb3VuZChcbiAgICAgICAgXCJncm91bmRcIixcbiAgICAgICAgeyB3aWR0aDogNTAsIGhlaWdodDogNTAgfSxcbiAgICAgICAgc2NlbmVcbiAgICApO1xuICAgIGdyb3VuZC5pc1Zpc2libGUgPSBmYWxzZTtcblxuICAgIC8qID09PT09PT09PSBcdTZBMjFcdTYyREYgM0QgXHU1NzMwXHU3NTM1XHU2QTIxXHU1NzhCID09PT09PT09PSAqL1xuICAgIHZhciBueCA9IDEwLCBueSA9IDUsIG56ID0gMTA7XG4gICAgdmFyIGR4ID0gMSwgZHkgPSAwLjYsIGR6ID0gMTtcblxuICAgIHZhciBtb2RlbFJvb3QgPSBuZXcgQkFCWUxPTi5UcmFuc2Zvcm1Ob2RlKFwibW9kZWxSb290XCIsIHNjZW5lKTtcblxuICAgIGZ1bmN0aW9uIHJlc2lzdGl2aXR5VG9Db2xvcih2KSB7XG4gICAgICAgIHZhciB0ID0gQkFCWUxPTi5TY2FsYXIuQ2xhbXAodiAvIDEwMCwgMCwgMSk7XG4gICAgICAgIHJldHVybiBuZXcgQkFCWUxPTi5Db2xvcjModCwgMC4yLCAxLjAgLSB0KTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG54OyBpKyspIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBueTsgaisrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IG56OyBrKyspIHtcblxuICAgICAgICAgICAgICAgIHZhciBkaXN0ID1cbiAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoaSAtIG54IC8gMikgK1xuICAgICAgICAgICAgICAgICAgICBNYXRoLmFicyhqIC0gbnkgLyAyKSArXG4gICAgICAgICAgICAgICAgICAgIE1hdGguYWJzKGsgLSBueiAvIDIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJlc2lzdGl2aXR5ID0gZGlzdCA8IDQgPyAyMCA6IDEyMDtcblxuICAgICAgICAgICAgICAgIHZhciBib3ggPSBCQUJZTE9OLk1lc2hCdWlsZGVyLkNyZWF0ZUJveChcbiAgICAgICAgICAgICAgICAgICAgXCJjZWxsXCIsXG4gICAgICAgICAgICAgICAgICAgIHsgd2lkdGg6IGR4LCBoZWlnaHQ6IGR5LCBkZXB0aDogZHogfSxcbiAgICAgICAgICAgICAgICAgICAgc2NlbmVcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgYm94LnBvc2l0aW9uLnNldChpICogZHgsIGogKiBkeSwgayAqIGR6KTtcblxuICAgICAgICAgICAgICAgIHZhciBtYXQgPSBuZXcgQkFCWUxPTi5TdGFuZGFyZE1hdGVyaWFsKFwibWF0XCIsIHNjZW5lKTtcbiAgICAgICAgICAgICAgICBtYXQuZGlmZnVzZUNvbG9yID0gcmVzaXN0aXZpdHlUb0NvbG9yKHJlc2lzdGl2aXR5KTtcbiAgICAgICAgICAgICAgICBtYXQuYWxwaGEgPSByZXNpc3Rpdml0eSA8IDUwID8gMC45IDogMC4zNTtcblxuICAgICAgICAgICAgICAgIGJveC5tYXRlcmlhbCA9IG1hdDtcbiAgICAgICAgICAgICAgICBib3gucGFyZW50ID0gbW9kZWxSb290O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbW9kZWxSb290LnBvc2l0aW9uLnggPSAtbnggKiBkeCAvIDI7XG4gICAgbW9kZWxSb290LnBvc2l0aW9uLnogPSAtbnogKiBkeiAvIDI7XG4gICAgbW9kZWxSb290LnBvc2l0aW9uLnkgPSAwLjU7XG5cbiAgICAvKiA9PT09PT09PT0gV2ViWFIoXHU2NzAwXHU1NDBFXHU1MjFCXHU1RUZBKSA9PT09PT09PT0gKi9cbiAgICBzY2VuZS5jcmVhdGVEZWZhdWx0WFJFeHBlcmllbmNlQXN5bmMoe1xuICAgICAgICBmbG9vck1lc2hlczogW2dyb3VuZF1cbiAgICB9KTtcblxuICAgIHJldHVybiBzY2VuZTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZVNjZW5lO1xuXG4vLyMgc291cmNlVVJMPWZpbGU6Ly8vcGcvaW5kZXguanMiXSwKICAibWFwcGluZ3MiOiAiO0FBQUEsSUFBSSxjQUFjLFdBQVk7QUFFMUIsTUFBSSxRQUFRLElBQUksUUFBUSxNQUFNLE1BQU07QUFDcEMsUUFBTSxhQUFhLElBQUksUUFBUSxPQUFPLE1BQU0sTUFBTSxNQUFNLENBQUM7QUFHekQsTUFBSSxTQUFTLElBQUksUUFBUTtBQUFBLElBQ3JCO0FBQUEsSUFDQSxDQUFDLEtBQUssS0FBSztBQUFBLElBQ1gsS0FBSyxLQUFLO0FBQUEsSUFDVjtBQUFBLElBQ0EsSUFBSSxRQUFRLFFBQVEsR0FBRyxHQUFHLENBQUM7QUFBQSxJQUMzQjtBQUFBLEVBQ0o7QUFDQSxTQUFPLGNBQWMsUUFBUSxJQUFJO0FBR2pDLE1BQUksUUFBUSxJQUFJLFFBQVE7QUFBQSxJQUNwQjtBQUFBLElBQ0EsSUFBSSxRQUFRLFFBQVEsR0FBRyxHQUFHLENBQUM7QUFBQSxJQUMzQjtBQUFBLEVBQ0o7QUFDQSxRQUFNLFlBQVk7QUFHbEIsTUFBSSxTQUFTLFFBQVEsWUFBWTtBQUFBLElBQzdCO0FBQUEsSUFDQSxFQUFFLE9BQU8sSUFBSSxRQUFRLEdBQUc7QUFBQSxJQUN4QjtBQUFBLEVBQ0o7QUFDQSxTQUFPLFlBQVk7QUFHbkIsTUFBSSxLQUFLLElBQUksS0FBSyxHQUFHLEtBQUs7QUFDMUIsTUFBSSxLQUFLLEdBQUcsS0FBSyxLQUFLLEtBQUs7QUFFM0IsTUFBSSxZQUFZLElBQUksUUFBUSxjQUFjLGFBQWEsS0FBSztBQUU1RCxXQUFTLG1CQUFtQixHQUFHO0FBQzNCLFFBQUksSUFBSSxRQUFRLE9BQU8sTUFBTSxJQUFJLEtBQUssR0FBRyxDQUFDO0FBQzFDLFdBQU8sSUFBSSxRQUFRLE9BQU8sR0FBRyxLQUFLLElBQU0sQ0FBQztBQUFBLEVBQzdDO0FBRUEsV0FBUyxJQUFJLEdBQUcsSUFBSSxJQUFJLEtBQUs7QUFDekIsYUFBUyxJQUFJLEdBQUcsSUFBSSxJQUFJLEtBQUs7QUFDekIsZUFBUyxJQUFJLEdBQUcsSUFBSSxJQUFJLEtBQUs7QUFFekIsWUFBSSxPQUNBLEtBQUssSUFBSSxJQUFJLEtBQUssQ0FBQyxJQUNuQixLQUFLLElBQUksSUFBSSxLQUFLLENBQUMsSUFDbkIsS0FBSyxJQUFJLElBQUksS0FBSyxDQUFDO0FBRXZCLFlBQUksY0FBYyxPQUFPLElBQUksS0FBSztBQUVsQyxZQUFJLE1BQU0sUUFBUSxZQUFZO0FBQUEsVUFDMUI7QUFBQSxVQUNBLEVBQUUsT0FBTyxJQUFJLFFBQVEsSUFBSSxPQUFPLEdBQUc7QUFBQSxVQUNuQztBQUFBLFFBQ0o7QUFFQSxZQUFJLFNBQVMsSUFBSSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksRUFBRTtBQUV2QyxZQUFJLE1BQU0sSUFBSSxRQUFRLGlCQUFpQixPQUFPLEtBQUs7QUFDbkQsWUFBSSxlQUFlLG1CQUFtQixXQUFXO0FBQ2pELFlBQUksUUFBUSxjQUFjLEtBQUssTUFBTTtBQUVyQyxZQUFJLFdBQVc7QUFDZixZQUFJLFNBQVM7QUFBQSxNQUNqQjtBQUFBLElBQ0o7QUFBQSxFQUNKO0FBRUEsWUFBVSxTQUFTLElBQUksQ0FBQyxLQUFLLEtBQUs7QUFDbEMsWUFBVSxTQUFTLElBQUksQ0FBQyxLQUFLLEtBQUs7QUFDbEMsWUFBVSxTQUFTLElBQUk7QUFHdkIsUUFBTSwrQkFBK0I7QUFBQSxJQUNqQyxhQUFhLENBQUMsTUFBTTtBQUFBLEVBQ3hCLENBQUM7QUFFRCxTQUFPO0FBQ1g7QUFFQSxJQUFPLGdCQUFROyIsCiAgIm5hbWVzIjogW10KfQo=\n";
    const blob = new Blob([code], { type: 'text/javascript' });
    const url = URL.createObjectURL(blob);

    const BABYLON = window.BABYLON;
    const canvas = document.getElementById('renderCanvas');

    // Import your bundled app (which exports createScene / default)
    const mod = await import(url);

    let engine = null;
    if (typeof mod.createEngine === 'function') {
      try { engine = await mod.createEngine(); } catch {}
    }
    if (!engine) {
      engine = new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true });
    }
    window.engine = engine; window.canvas = canvas;

    let createScene = mod.createScene || mod.default;
    if (!createScene && mod.Playground?.CreateScene) createScene = (e,c)=>mod.Playground.CreateScene(e,c);
    if (!createScene) throw new Error('No createScene() export found.');

    const scene = await (createScene(engine, canvas) ?? createScene());
    engine.runRenderLoop(()=>scene.render());
    addEventListener('resize', ()=>engine.resize());

    addEventListener('unload', ()=> URL.revokeObjectURL(url));
  </script>
</body>
</html>